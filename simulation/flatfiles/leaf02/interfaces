# /etc/network/interfaces template for switches (leaf02)
# Created by Ansible

# Loopback interface
auto lo
iface lo inet loopback
  address 10.0.0.12/32
  alias loopback interface

# Management interface

auto eth0
iface eth0 inet dhcp
    vrf mgmt

auto mgmt
iface mgmt
    address 127.0.0.1/8
    vrf-table auto

# Port to Server03
auto swp1
iface swp1
  alias to Server03
  bridge-access 100

# Port to Server04
auto swp2
iface swp2
  alias to Server04
  bridge-access 100

# Port to Leaf01
auto swp13
iface swp13
  alias to Leaf01

# Port to Leaf01
auto swp14
iface swp14
  alias to Leaf01

# Port to Spine01
auto swp15
iface swp15
  alias to Spine01

# Port to Spine02
auto swp16
iface swp16
  alias to Spine02


# Define the bridge for STP
auto bridge
iface bridge
  bridge-vlan-aware yes
  bridge-ports swp1 swp2 vni100
  bridge-vids 100
  bridge-pvid 1


# VxLAN Tunnel for Server1-Server3 (Vlan 100)
auto vni100
iface vni100
  vxlan-id 10100
  vxlan-local-tunnelip 10.0.0.12
  bridge-access 100
  bridge-learning off
  mstpctl-bpduguard yes
  mstpctl-portbpdufilter yes

auto public
iface public
   vrf-table auto

auto vlan100
iface vlan100
    address 185.2.136.241/28
    address 2A02:2498:E004:4F::2/64
    vlan-id 100
    vlan-raw-device bridge
    vrf public
